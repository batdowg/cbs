{% extends 'base.html' %}
{% block title %}Session {{ session.title }}{% endblock %}
{% block content %}
<h1>{{ session.title }}</h1>
<p>Code: {{ session.code }}<br>Start: {{ session.start_date }} End: {{ session.end_date }}</p>
<h2>Participants</h2>
<form action="{{ url_for('sessions.add_participant', session_id=session.id) }}" method="post">
  <input type="email" name="email" placeholder="Email" required>
  <input type="text" name="full_name" placeholder="Full name">
  <button type="submit">Add Participant</button>
</form>
<table border="1" cellpadding="4" cellspacing="0">
  <tr><th>Full Name</th><th>Email</th><th>Completion Date</th><th>Actions</th></tr>
  {% for row in participants %}
  <tr>
    <td>{{ row.participant.full_name }}</td>
    <td>{{ row.participant.email }}</td>
    <td>
      <form action="{{ url_for('sessions.generate_single', session_id=session.id, participant_id=row.participant.id) }}" method="post">
        <input type="date" name="completion_date" value="{{ row.link.completion_date }}">
        <button type="submit" name="action" value="save">Save</button>
        <button type="submit" name="action" value="generate">Generate</button>
      </form>
    </td>
  </tr>
  {% endfor %}
</table>
<form action="{{ url_for('sessions.generate_bulk', session_id=session.id) }}" method="post">
  <button type="submit">Generate Certificates</button>
</form>
{% endblock %}
