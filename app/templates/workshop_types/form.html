{% extends 'base.html' %}
{% block title %}{{ 'New Workshop Type' if not wt else 'Edit Workshop Type' }}{% endblock %}
{% block content %}
{% if wt %}
<div style="display:flex; align-items:center; gap:var(--space-3);">
  <h1>Edit Workshop Type</h1>
  {% if current_user and (current_user.is_app_admin or current_user.is_admin or current_user.is_kt_delivery or current_user.is_kt_contractor) %}
  <a href="{{ url_for('workshop_types.prework', type_id=wt.id) }}">Prework</a>
  {% endif %}
</div>
{% else %}
<h1>New Workshop Type</h1>
{% endif %}
<form method="post">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
  {% include 'workshop_types/_fields.html' %}
  {% include 'workshop_types/_defaults_table.html' %}
  <button type="submit">Save</button>
</form>
<script src="{{ url_for('static', filename='js/material_picker.js') }}"></script>
<script>
document.addEventListener('DOMContentLoaded', function(){
  document.querySelectorAll('.delete-default').forEach(function(btn){
    btn.addEventListener('click', function(){
      var url = btn.dataset.url;
      fetch(url, {method:'POST'}).then(function(r){ if(r.ok){ btn.closest('tr').remove(); }});
    });
  });
});
</script>
{% endblock %}
