{% extends 'base.html' %}
{% block title %}Resources{% endblock %}
{% block content %}
<div class="kt-card">
<h1 class="kt-card-title">Resources</h1>
<p><a href="{{ url_for('settings_resources.new_resource') }}">New Resource</a></p>
<form method="get" class="filters">
  <div class="filter-row">
    <label>Audience
      <select name="audience">
        <option value="">All audiences</option>
        {% for choice in audience_choices %}
          <option value="{{ choice }}" {% if selected_audience == choice %}selected{% endif %}>{{ choice }}</option>
        {% endfor %}
      </select>
    </label>
    <label>Language
      <select name="language">
        <option value="">All languages</option>
        {% for code, label in language_options %}
          <option value="{{ code }}" {% if selected_language == code %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
    </label>
    <button type="submit" class="btn btn-secondary btn-sm">Filter</button>
    <a href="{{ url_for('settings_resources.list_resources') }}" class="btn btn-link">Clear</a>
  </div>
</form>
<div class="kt-table-wrapper">
  <table class="kt-table">
    <thead>
      <tr>
        <th scope="col">Name</th>
        <th scope="col">Type</th>
        <th scope="col">Audience</th>
        <th scope="col">Language</th>
        <th scope="col">Target</th>
        <th scope="col">Workshop Types</th>
        <th scope="col">Active</th>
        <th scope="col" class="col-actions">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% if resources %}
        {% for r in resources %}
        <tr>
          <td>{{ r.name }}</td>
          <td>{{ r.type }}</td>
          <td>{{ r.audience }}</td>
          <td>{{ r.language | lang_label }}</td>
          <td>
            {% if r.type == 'DOCUMENT' %}
              {{ r.resource_value }}
            {% else %}
              <a href="{{ r.resource_value }}" target="_blank">{{ r.resource_value }}</a>
            {% endif %}
          </td>
          <td>{% for wt in r.workshop_types %}{{ wt.name }}{% if not loop.last %}, {% endif %}{% endfor %}</td>
          <td>{{ 'Yes' if r.active else 'No' }}</td>
          <td class="col-actions"><a href="{{ url_for('settings_resources.edit_resource', res_id=r.id) }}">Edit</a></td>
        </tr>
        {% endfor %}
      {% else %}
        {% with colspan=8 %}

          {% include 'shared/_table_empty.html' %}

        {% endwith %}
      {% endif %}
    </tbody>
  </table>
</div>
</div>
{% endblock %}
