{% macro render_item(item) %}
  {% if item.children %}
    <details class="{{ item.id }}">
      <summary class="nav-link">{{ item.label }}</summary>
      <ul>
      {% for child in item.children %}
        <li>{{ render_item(child) }}</li>
      {% endfor %}
      </ul>
    </details>
  {% else %}
    <a href="{{ url_for(item.endpoint, **(item.args or {})) }}">{{ item.label }}</a>
  {% endif %}
{% endmacro %}
<nav>
  <a href="/{{''}}"><img src="{{ url_for('static', filename='ktlogo1.png') }}" onerror="this.onerror=null;this.src='/logo.png';" alt="KT Logo" style="max-height:48px;"></a>
  {% for item in nav_menu %}
    {{ render_item(item) }}
  {% endfor %}
  {% if view_options|length > 1 %}
  <form method="post" action="{{ url_for('settings_view') }}" style="margin-top:1rem;">
    <label>View:</label>
    <select name="view" onchange="this.form.submit()">
      {% for opt in view_options %}
      <option value="{{ opt }}" {% if opt == active_view %}selected{% endif %}>{{ opt.replace('_',' ').title() }}</option>
      {% endfor %}
    </select>
  </form>
  {% endif %}
</nav>
