{% macro render_item(item) %}
  {% if item.children %}
    <details class="{{ item.id }}{% if item.is_ancestor %} is-ancestor{% endif %}">
      <summary class="nav-link">{{ item.label }}</summary>
      <ul class="kt-subnav">
      {% for child in item.children %}
        <li{% if child.is_ancestor %} class="is-ancestor"{% endif %}>{{ render_item(child) }}</li>
      {% endfor %}
      </ul>
    </details>
  {% else %}
    <a href="{{ item.href }}"{% if item.is_current %} aria-current="page"{% endif %}>{{ item.label }}</a>
  {% endif %}
{% endmacro %}
<nav class="kt-nav">
  <a href="/{{''}}"><img src="{{ url_for('static', filename='ktlogo1.png') }}" onerror="this.onerror=null;this.src='/logo.png';" alt="KT Logo" style="max-height:48px;"></a>
  {% for item in nav_menu %}
    {{ render_item(item) }}
  {% endfor %}
  {% if view_options|length > 1 %}
  <form method="post" action="{{ url_for('settings_view') }}" class="kt-sidebar-footer">
    <label>View:</label>
    <select name="view" onchange="this.form.submit()">
      {% for opt in view_options %}
      {% set label = opt.replace('_', ' ').title() %}
      <option value="{{ opt }}" {% if opt == active_view %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
  </form>
  {% endif %}
</nav>
