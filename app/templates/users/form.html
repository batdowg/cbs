{% extends 'base.html' %}
{% block title %}{{ 'New User' if not user else 'Edit User' }}{% endblock %}
{% block content %}
{% with msgs = get_flashed_messages(with_categories=true) %}
  {% if msgs %}<ul class="flashes">{% for cat,msg in msgs %}<li class="{{cat}}">{{msg}}</li>{% endfor %}</ul>{% endif %}
{% endwith %}
<h1>{{ 'New User' if not user else 'Edit User' }}</h1>
<form method="post" autocomplete="off">
  <input type="text" style="display:none">
  <input type="password" style="display:none">
  {% if not user %}
  <div><label>Email <input type="email" name="email" required autocomplete="off"></label></div>
  {% else %}
  <div><label>Email <input type="email" name="email" value="{{ user.email }}" readonly autocomplete="off"></label></div>
  {% endif %}
  <div><label>Full Name <input type="text" name="full_name" value="{{ user.full_name if user else '' }}"></label></div>
  <div><label>New Password <input type="password" name="password" autocomplete="new-password"></label></div>
  <div><label>Region
    <select name="region" required>
      <option value="">--Select--</option>
      {% for opt in ['NA','EU','SEA','Other'] %}
      <option value="{{ opt }}" {% if user and user.region==opt %}selected{% endif %}>{{ opt }}</option>
      {% endfor %}
    </select>
  </label></div>
  <div>
    <label><input type="checkbox" name="is_app_admin" {% if user and user.is_app_admin %}checked{% endif %} {% if not current_user.is_app_admin %}disabled{% endif %}> Application Admin</label><br>
    <label><input type="checkbox" name="is_admin" {% if user and user.is_admin %}checked{% endif %}> Admin</label><br>
    <label><input type="checkbox" name="is_kcrm" {% if user and user.is_kcrm %}checked{% endif %}> KCRM</label><br>
    <label><input type="checkbox" name="is_kt_delivery" {% if user and user.is_kt_delivery %}checked{% endif %}> KT Delivery</label><br>
    <label><input type="checkbox" name="is_kt_contractor" {% if user and user.is_kt_contractor %}checked{% endif %}> KT Contractor</label><br>
    <label><input type="checkbox" name="is_kt_staff" {% if user and user.is_kt_staff %}checked{% endif %}> KT Staff</label><br>
  </div>
  <button type="submit">Save</button>
</form>
{% endblock %}

