{% extends 'base.html' %}
{% block title %}Users{% endblock %}
{% block content %}
<h1>Users</h1>
<p><a href="{{ url_for('users.new_user') }}">New User</a></p>
<table>
  <tr>
    <th>Email</th>
    <th>Full Name</th>
    <th>Roles</th>
    <th>Created</th>
    <th></th>
  </tr>
  {% for u in users %}
  <tr>
    <td>{{ u.email }}</td>
    <td>{{ u.full_name }}</td>
    <td>
      {% set roles = [] %}
      {% if u.is_app_admin %}{% set _ = roles.append('App Admin') %}{% endif %}
      {% if u.is_admin %}{% set _ = roles.append('Admin') %}{% endif %}
      {% if u.is_kcrm %}{% set _ = roles.append('KCRM') %}{% endif %}
      {% if u.is_kt_delivery %}{% set _ = roles.append('KT Delivery') %}{% endif %}
      {% if u.is_kt_contractor %}{% set _ = roles.append('KT Contractor') %}{% endif %}
      {% if u.is_kt_staff %}{% set _ = roles.append('KT Staff') %}{% endif %}
      {{ roles|join(', ') }}
    </td>
    <td>{{ u.created_at.strftime('%Y-%m-%d') if u.created_at }}</td>
    <td><a href="{{ url_for('users.edit_user', user_id=u.id) }}">Edit</a></td>
  </tr>
  {% endfor %}
</table>
{% endblock %}

