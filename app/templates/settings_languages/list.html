{% extends 'base.html' %}
{% block title %}Languages{% endblock %}
{% block content %}
<div class="kt-card">
<h1 class="kt-card-title">Languages</h1>
<p class="form-help">Admin: align font list to KT branding; upload/install TTFs as needed.</p>
<p><a href="{{ url_for('settings_languages.new_lang') }}">New language</a></p>
<div class="kt-table-wrapper">
  <table class="kt-table">
    <thead>
      <tr>
        <th scope="col">Name</th>
        <th scope="col">Allowed fonts</th>
        <th scope="col" class="cell-nowrap">Sort Order</th>
        <th scope="col" class="cell-nowrap">Status</th>
        <th scope="col" class="col-actions">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% if langs %}
        {% for lang in langs %}
        <tr>
          <td>{{ lang.name }}</td>
          <td>
            {% set codes = lang.allowed_fonts or [] %}
            {% set ns = namespace(labels=[]) %}
            {% for code in codes %}
              {% set label = font_labels.get(code, code) %}
              {% set ns.labels = ns.labels + [label] %}
            {% endfor %}
            {{ ns.labels|join(', ') if ns.labels else 'â€”' }}
          </td>
          <td class="cell-nowrap">{{ lang.sort_order }}</td>
          <td class="cell-nowrap">{{ 'Active' if lang.is_active else 'Inactive' }}</td>
          <td class="col-actions inline-gap-sm">
            <a href="{{ url_for('settings_languages.edit_lang', lang_id=lang.id) }}">Edit</a>
            <form method="post" action="{{ url_for('settings_languages.toggle_lang', lang_id=lang.id) }}">
              <button class="btn {{ 'btn-danger' if lang.is_active else 'btn-secondary' }} btn-sm" type="submit">{{ 'Deactivate' if lang.is_active else 'Activate' }}</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      {% else %}
        {% with colspan=5 %}

          {% include 'shared/_table_empty.html' %}

        {% endwith %}
      {% endif %}
    </tbody>
  </table>
</div>
</div>
{% endblock %}
